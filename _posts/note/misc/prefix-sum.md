---
title: 前綴和與差分
---
# 前綴和與差分

序列 $A_1,A_2,\dots,A_n$ 的長度為 $i$ 的前綴和記作 $S_i$，而 $S_0=0$，可以用來計算區間和：

$$ \sum_{i=l}^r A_i = S_r - S_{l-1} $$

而差分 $D_i$ 是 $A_i-A_{i-1}$，特別地令 $A_0=D_0=0$。差分的前綴和就是原序列，區間和就是原序列某兩項的差。

> 給一個序列 $A_1,A_2,\dots,A_n$，有 $q$ 筆操作，第 $i$ 筆操作為將序列 $A$ 的區間 $[l_i, r_i]$ 加上 $v_i$。求做完所有操作後，序列 $A$ 的樣子。

注意到區間 $[l,r]$ 加 $v$ 的時候，$D_l$ 會多出 $v$、$D_{r+1}$ 會少 $v$，其他都不會變。既然不需要中途詢問，那就可以在操作的過程中維護 $D$，最後再算前綴和就能得到 $A$。

前綴和跟差分如果要帶修改，可以搭配 [BIT](/fenwick-tree)。